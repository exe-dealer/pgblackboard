<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
  <title>pgBlackboard</title>

  <script type="text/javascript">
    if(navigator.userAgent.indexOf('AppleWebKit') === -1){
      alert('Your browser is not WebKit based.');
    }
  </script>

  <link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.css"  rel="stylesheet" />
  <link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/theme/monokai.min.css" rel="stylesheet" />

  <link href="style.css" rel="stylesheet" />

  <script id="tree-tmpl" type="text/html">
    <ul data-bind-foreach="nodes">
      <li class="treenode" data-bind-attr.data-type="type">

        <button data-bind-click="toggle"
                data-bind-visible="!isLeaf"
                data-bind-css.treenode-toggler-collapsed="!isExpanded()"
                data-bind-css.treenode-toggler-expanded="isExpanded"
                data-bind-css.spinner="childrenAreLoading"></button>

        <header class="itemheader"
                data-bind-css.itemheader-active="isOpened">

          <a data-bind-click="$root.openTreeNode.bind($root)"
             data-bind-attr.title="comment">
            <i class="treenode-icon" data-bind-attr.data-type="type"></i>
            <span data-bind-text="name"></span>
            <small data-bind-text="comment"></small>
          </a>

        </header>

        <!-- ko template: {
          name : 'tree-tmpl',
          if   : isExpanded
        } --><!-- /ko -->

      </li>
    </ul>
  </script>

  <script id="queries-tmpl" type="text/html">
    <ul data-bind-foreach="items">
      <li>
        <header class="itemheader"
                data-bind-css.itemheader-active="isOpened">
          <a data-bind-click="$root.openStoredQuery.bind($root)">
            <i class="icon-code"></i>
            <span data-bind-text="name"></span>
          </a>

          <button data-bind-click="$root.removeStoredQuery.bind($root)"
                  data-bind-visible="isOpened">remove</button>

        </header>
      </li>
    </ul>
  </script>
</head>
<body class="splitpanel-h">

  <section id="leftpanel" class="scrollbox splitfix">
    <!-- ko template: { name: 'queries-tmpl', data: queries } --><!-- /ko -->
    <!-- ko template: { name: 'tree-tmpl', data: tree } --><!-- /ko -->
  </section>

  <div class="splitter"></div>

  <section class="splitstretch splitpanel-v">
    <form id="queryform"
          method="POST"
          action=""
          target="result"
          class="splitstretch"
          enctype="application/x-www-form-urlencoded">

      <textarea id="query" name="query"
        >\connect postgres&#13;&#10;select 'hello, ' || current_user; -- Alt+X to execute</textarea>

      <input type="hidden" name="selection" />

      <div id="execbar">
        <button type="submit"
                title="alt-m"
                accesskey="m"
                formaction="map">
          map
        </button>

        <button class="execute-action"
                type="submit"
                title="alt-x"
                accesskey="x">
          execute
        </button>
      </div>

      <div class="spinner-shield" data-bind="visible: queryTextIsLoading()">
        <div class="spinner"></div>
      </div>

    </form>
    <div class="splitter"></div>
    <iframe id="result" name="result" class="scrollbox splitfix"></iframe>
  </section>


  <button id="share-action" accesskey="s" style="display:none"></button>


  <script src="//cdn.jsdelivr.net/knockout/3.1.0/knockout.js"></script>
  <script src="http://exe-dealer.github.io/knockout-flatBindingProvider/dist/knockout-flatBindingProvider.js"></script>
  <script>ko.bindingProvider.instance = new ko.flatBindingProvider();</script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/sql/sql.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/search/searchcursor.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/keymap/sublime.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/edit/matchbrackets.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/edit/closebrackets.min.js"></script>

  <script src="script.js"></script>
</body>
</html>
