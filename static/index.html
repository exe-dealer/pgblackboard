<!DOCTYPE html>
<html>
<head>
    <title>pgBlackboard</title>
    <link href="/layout.css" rel="stylesheet" type="text/css" />
    <link href="/dark.css" rel="stylesheet" type="text/css" />
    <link href="/tree.css" rel="stylesheet" type="text/css" />
</head>
<body class="splitpanel-h">

    <section id="leftpanel" class="scrollbox splitfix">
        <!-- ko template: { name: 'my-queries-tmpl', data: queries } --><!-- /ko -->
        <!-- ko template: { name: 'tree-node-list-tmpl', data: tree } --><!-- /ko -->
    </section>

    <div class="splitter"></div>

    <section class="splitstretch splitpanel-v">
        <form id="code-form" method="POST" action="" target="result"
            class="code-form splitstretch">
            <code id="code" class="code"></code>
            <input type="hidden" name="query" id="query-input" />

            <div id="exec-commands">
                <button id="exec-map" class="action" title="Alt+M"
                        accesskey="m" type="submit"
                        name="format" value="map"></button>

                <button id="exec-table" class="action" title="Alt+E"
                        accesskey="e" type="submit"
                        name="format" value="html"></button>
            </div>
        </form>
        <div class="splitter"></div>
        <iframe name="result" class="result scrollbox splitfix"></iframe>
    </section>


    <script type="text/html" id="tree-tmpl">
        <section class="tree" data-bind="template: { name: 'tree-node-list-tmpl' }">
        </section>
    </script>

    <script type="text/html" id="tree-node-list-tmpl">
        <ul class="tree-node-list" data-bind="foreach: nodes">
            <li class="tree-node">
                <header class="tree-node-header">
                    <button class="hitarea tree-node-toggler"
                            data-bind="click: toggle,
                                       css: {
                                            'tree-node-toggler_hidden': isLeaf,
                                            'tree-node-toggler_collapsed': isCollapsed,
                                            'tree-node-toggler_expanded': isExpanded,
                                            'tree-node-toggler_loading': childrenAreLoading,
                                       }"></button>
                    <a class="tree-node-name-and-comment"
                       data-bind="click: open, attr: { title: comment }">

                        <span class="tree-node-name"
                            data-bind="template: { name: nameTmpl, data: obj }"></span>
                        <small class="tree-node-comment"
                            data-bind="text: comment"></small>
                    </a>
                </header>
                <!-- ko template: { name: 'tree-node-list-tmpl', if: isExpanded } --><!-- /ko -->
            </li>
        </ul>
    </script>

    <script type="text/html" id="database-tree-node-name-tmpl">
        <span class="icon-database" data-bind="text: name"></span>
    </script>

    <script type="text/html" id="schema-tree-node-name-tmpl">
        <span class="icon-popup" data-bind="text: name"></span>
    </script>

    <script type="text/html" id="table-tree-node-name-tmpl">
        <span class="icon-table" data-bind="text: name"></span>
    </script>

    <script type="text/html" id="func-tree-node-name-tmpl">
        <span class="icon-code" data-bind="text: name"></span>
    </script>

    <script type="text/html" id="column-tree-node-name-tmpl">
        <span class="icon-doc-text-1">
            <span data-bind="text: name"></span>
            : <span data-bind="text: dataType"></span>
        </span>
    </script>

    <script type="text/html" id="my-queries-tmpl">
        <section class="my-queries">
            <ul class="my-queries-list" data-bind="foreach: items">
                <li class="my-queries-item"
                    data-bind="css: { 'my-queries-item-current': isCurrent }">

                    <a href="#" class="icon-code my-queries-item-name"
                       data-bind="click: open, text: name"></a>

                    <button class="action my-queries-item-del"
                            data-bind="click: remove"></button>
                </li>
            </ul>
            <button class="action" data-bind="click: add">new query</button>
        </section>
    </script>



    <script src="//cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/knockout/3.1.0/knockout-min.js"></script>
    <script src="/tree.js" type="text/javascript"></script>
    <script src="/queries.js" type="text/javascript"></script>
    <script src="/app.js" type="text/javascript"></script>
    <script src="/splitpanel.js" type="text/javascript"></script>
</body>
</html>
