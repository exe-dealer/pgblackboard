<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>pgBlackboard</title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/knockout/3.1.0/knockout-min.js"></script>
  <link href="style.css" rel="stylesheet" />
  <script src="app.js"></script>
</head>
<body class="splitpanel-h">

  <section id="leftpanel" class="scrollbox splitfix">
    <!-- ko template: { name: 'queries-tmpl', data: queries } --><!-- /ko -->
    <!-- ko template: { name: 'tree-node-list-tmpl', data: tree } --><!-- /ko -->
  </section>

  <div class="splitter"></div>

  <section class="splitstretch splitpanel-v">
    <form id="code-form" method="POST" action="" target="result"
      class="code-form splitstretch" enctype="multipart/form-data">

      <code id="code" class="code"></code>
      <input type="hidden" name="query" id="query-input" />

      <div id="exec-commands">
        <button id="exec-map" class="action" title="Alt+M"
          accesskey="m" type="submit"
          name="format" value="map"></button>

        <button id="exec-table" class="action" title="Alt+E"
          accesskey="e" type="submit"
          name="format" value="html"></button>
      </div>

      <div class="spinner-shield"
        data-bind="css: { visible: treeNodeQueryIsLoading() }"></div>

    </form>
    <div class="splitter"></div>
    <iframe name="result" class="result scrollbox splitfix"></iframe>
  </section>


  <script type="text/html" id="tree-tmpl">
    <section class="tree" data-bind="template: { name: 'tree-node-list-tmpl' }">
    </section>
  </script>

  <script type="text/html" id="tree-node-list-tmpl">
    <ul class="tree-node-list" data-bind="foreach: nodes">
      <li class="tree-node">

        <header class="tree-node-header">

          <button class="hitarea tree-node-toggler"
            data-bind="click: toggle, css: {
              'tree-node-toggler_hidden': isLeaf,
              'tree-node-toggler_collapsed': !isExpanded(),
              'tree-node-toggler_expanded': isExpanded,
              'tree-node-toggler_loading': childrenAreLoading }"></button>

          <a class="sideitem tree-node-link tree-node-icon"
            data-bind="click: $root.openTreeNode.bind($root),
                       css: { 'sideitem-opened': isOpened },
                       attr: { title: comment, 'data-type': type }"
            ><!-- ko text: name --><!-- /ko -->
            <small class="tree-node-comment" data-bind="text: comment"></small>
          </a>

        </header>

        <!-- ko template: {
          name: 'tree-node-list-tmpl',
          if: isExpanded
        } --><!-- /ko -->

      </li>
    </ul>
  </script>

  <script type="text/html" id="queries-tmpl">
    <section class="queries">
      <ul class="queries-list" data-bind="foreach: items">
        <li class="queries-item sideitem"
          data-bind="css: { 'sideitem-opened': isOpened }">

          <a href="#" class="icon-code queries-item-name"
            data-bind="click: $root.openStoredQuery.bind($root), text: name"></a>

          <button class="action queries-item-del"
            data-bind="click: $root.removeStoredQuery.bind($root)"></button>

        </li>
      </ul>
      <!-- <button class="action" data-bind="click: add">new query</button> -->
    </section>
  </script>

  <script>main()</script>
</body>
</html>
